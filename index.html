<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ø·Ù†Ø· ÙƒÙˆÙƒÙŠ â€” Ø§Ø·Ù„Ø¨ Ø¨Ø¨Ø³Ø§Ø·Ø©</title>
  <meta name="theme-color" content="#d40000">
  <style>
    :root{
      --brand:#d40000; --brand-d:#b60000;
      --ink:#0b0f19; --bg:#fff7f7; --plate:#0d0d0f;
      --muted:#70757d; --card:#ffffff; --border:#f0c4c4;
      --danger:#dc2626; --warn:#f59e0b;
      --radius:18px; --shadow:0 6px 24px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:'Cairo',system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
    a{text-decoration:none}

    .topbar{position:sticky;top:0;z-index:20;background:var(--brand);color:#fff}
    .topbar-inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;gap:12px;padding:10px 14px}
    .logo img{height:46px;width:46px;border-radius:50%}
    .brand{font-size:20px;font-weight:900}
    .spacer{flex:1}
    .btn{background:#fff;color:var(--brand);padding:10px 14px;border-radius:999px;border:none;font-weight:800;cursor:pointer;box-shadow:var(--shadow)}
    .btn:hover{background:#fff1f1; color: var(--brand)}
    .ghost{background:transparent;color:#fff;border:3px solid rgba(255,255,255,.6)}

    .hero{background:radial-gradient(1200px 400px at 100% 0%, rgba(255,255,255,.16), transparent 60%), var(--brand);color:#fff;position:relative}
    .pattern{background-image: var(--pattern-url);background-repeat:repeat;background-size:280px auto;opacity:.3;position:absolute;inset:0;pointer-events:none}
    .hero-wrap{max-width:1200px;margin:0 auto;position:relative;padding:22px 14px 16px}
    .hero h1{margin:0 0 6px;font-size:28px}
    .hero p{margin:0;color:#ffecec}
    .chip{display:inline-flex;gap:6px;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.35);color:#fff;padding:6px 10px;border-radius:999px;font-size:13px;margin-top:8px}

    .wrap{max-width:1200px;margin:0 auto;padding:0 14px 90px}
    .toolbar{background:#fff;box-shadow:var(--shadow);border-radius:var(--radius);padding:12px;display:grid;gap:10px;
      grid-template-columns:1.2fr .7fr .7fr .6fr .6fr auto;align-items:center;margin:14px 0}
    .search{padding:12px 14px;border:1px solid var(--border);border-radius:12px;outline:none}
    .select,.input{padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:#fff}
    .switch{display:flex;align-items:center;gap:8px;font-size:14px}
    .switch input{accent-color:var(--brand);width:18px;height:18px}
    .reload{background:var(--brand);color:#fff;padding:10px 14px;border:none;border-radius:12px;font-weight:800;cursor:pointer}
    .reload:hover{background:var(--brand-d)}
    @media (max-width:980px){ .toolbar{grid-template-columns:1fr 1fr 1fr 1fr} }
    @media (max-width:560px){ .toolbar{grid-template-columns:1fr 1fr} }

    .grid{display:grid;grid-template-columns:repeat(auto-fill, minmax(230px,1fr));gap:14px}
    .card{background:#fff;border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:10px;position:relative;overflow:hidden;transform:translateZ(0)}
    .plate{border: 4px solid #d40000;width:100%;aspect-ratio:1;border-radius:18px;background:
        radial-gradient(circle at 30% 20%, rgba(255,255,255,.08), transparent 20%),
        radial-gradient(120px 120px at 70% 70%, rgba(255,255,255,.06), transparent 40%),
        var(--plate);
      display:flex;align-items:center;justify-content:center;margin-bottom:10px;position:relative;overflow:hidden}
    .plate img{width:100%;height:100%;object-fit:cover;border-radius:12px}
    .badge{position:absolute;top:8px;inset-inline-start:8px;background:#fff;color:var(--brand);border:1px solid var(--border);
      padding:5px 8px;border-radius:999px;font-size:12px;font-weight:800}
    .badge.oos{color:#fff;background:var(--danger);border-color:#7f1d1d}
    .badge.new{background:var(--warn);color:#111;border-color:#b45309}
    .name{font-weight:900;margin:2px 0 4px;font-size:16px}
    .desc{color:#70757d;font-size:13px;min-height:34px}
    .row{display:flex;align-items:center;justify-content:space-between;gap:6px;margin-top:10px}
    .price{font-size:18px;font-weight:900}
    .old{color:#9aa1a9;text-decoration:line-through;font-weight:600;font-size:13px;margin-inline-start:8px}
    .brandTag{font-size:12px;background:#fff2f2;color:#7a0a0a;border:1px solid var(--border);padding:4px 8px;border-radius:999px}

    .choose{display:flex;gap:8px;margin-top:10px;align-items:center}
    .add{flex:1;background:var(--brand);color:#fff;border:none;border-radius:12px;padding:10px 12px;font-weight:800;cursor:pointer;transition:transform .06s ease}
    .add:active{transform:scale(.98)}
    .stepper{display:none;gap:8px;align-items:center}
    .stepper.show{display:flex}
    .step{width:36px;height:36px;border-radius:12px;border:1px solid var(--border);background:#fff;font-weight:900;cursor:pointer}
    .qty{min-width:36px;text-align:center;font-weight:900}

    .orderbar{
      position:fixed;
      inset-inline:14px;
      bottom:14px;
      font-size:1em;
      background:linear-gradient(135deg,var(--brand),#8b0000);
      color:#fff;
      border-radius:18px;
      display:flex;
      align-items:stretch;
      gap:10px;
      padding:10px 12px;
      box-shadow:var(--shadow);
      z-index:50;
      flex-wrap:wrap;
    }
    .orderbar .go{
      background:#22c55e;
      color:#fff;
      border:none;
      border-radius:999px;
      padding:10px 16px;
      font-weight:900;
      cursor:pointer;
      font-size:1em;
      white-space:nowrap;
    }
    .orderbar .clear{
      background:transparent;
      color:#fff;
      border:1px solid rgba(255,255,255,.35);
      border-radius:999px;
      padding:9px 14px;
      font-weight:700;
      cursor:pointer;
      font-size:.9em;
      white-space:nowrap;
    }
    .orderbar .count{
      font-weight:900;
      font-size:.95em;
    }
    .orderbar .cartbtn{
      background:#111827;
      color:#fff;
      border-radius:999px;
      padding:9px 12px;
      font-weight:800;
      font-size:.9em;
      white-space:nowrap;
    }
    .order-actions{
      display:flex;
      align-items:center;
      gap:8px;
      flex:0 0 auto;
    }
    @media (max-width:720px){
      .orderbar{
        flex-direction:column;
        align-items:stretch;
      }
      .order-info{
        width:100%;
      }
      .order-actions{
        width:100%;
        display:grid;
        grid-template-columns:1.6fr 1.1fr auto; /* Ø¥Ø±Ø³Ø§Ù„ | Ø¹Ø±Ø¶ | Ù…Ø³Ø­ */
      }
    }
    @media (min-width:760px){
      .orderbar{
        inset-inline:calc(50% - 360px);
        width:720px;
      }
    }

    /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø¨Ø³ÙŠØ· ÙŠØ´Ø¯ Ø§Ù„Ø¹ÙŠÙ† Ù„Ù„Ø´Ø±ÙŠØ· */
    .pulse{animation:barBounce .55s ease}
    @keyframes barBounce{
      0%{transform:translateY(12px);}
      35%{transform:translateY(0);}
      70%{transform:translateY(6px);}
      100%{transform:translateY(0);}
    }
    canvas.confetti{position:fixed;inset:0;pointer-events:none;z-index:100}
    /* === Cart drawer (preview) === */
    .cartbtn{background:#fff;color:#111;border:none;border-radius:10px;padding:10px 12px;font-weight:800;cursor:pointer}
    .drawer{position:fixed;inset-inline:auto 14px;bottom:76px;width:min(92vw,380px);max-height:50vh;overflow:hidden;
            background:#ffffff;border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);
            transform:translateY(12px);opacity:0;pointer-events:none;transition:.18s ease;z-index:60}
    .drawer.show{transform:translateY(0);opacity:1;pointer-events:auto}
    .drawer h3{margin:10px 12px 0;font-size:16px}
    .cartlist{list-style:none;margin:6px 0 10px;padding:0;
              max-height:calc(50vh - 44px); /* Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ - Ø§Ù„Ù‡ÙŠØ¯Ø± */
              overflow-y:auto;}
    .cartlist li{display:flex;justify-content:space-between;gap:6px;padding:8px 12px;border-top:1px dashed var(--border)}
    .cartlist .meta{color:#70757d;font-size:12px}
    .cartlist .qty{font-weight:900}

    .drawer-header{display:flex;align-items:center;justify-content:space-between;padding:8px 12px 4px}
    .drawer-header h3{margin:0;font-size:15px}
    .drawer-close{background:transparent;border:none;font-size:18px;font-weight:900;cursor:pointer;padding:0 4px;color:#111}

    /* === Checkout modal === */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:80}
    .overlay.show{display:flex}
    .modal{width:min(92vw,520px);background:#fff;border-radius:18px;border:1px solid var(--border);box-shadow:var(--shadow);padding:14px}
    .modal h3{margin:0 0 10px}
    .formrow{display:grid;gap:8px;margin:8px 0}
    .formrow input,.formrow textarea{padding:10px 12px;border:1px solid var(--border);border-radius:12px;width:100%}
    .mfoot{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}
    .mfoot .cancel{background:transparent;border:1px solid var(--border);border-radius:10px;padding:10px 12px;cursor:pointer}
    .mfoot .ok{background:var(--brand);color:#fff;border:none;border-radius:10px;padding:10px 12px;font-weight:800;cursor:pointer}

    /* === Ø­Ø§Ù„Ø© Ø¥Ø®ÙØ§Ø¡ Ø¹Ø§Ù…Ø© === */
    .hidden{display:none !important}

    /* === Ø¹Ø±Ø¶ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ù„Ø­ÙˆÙ… / Ø¯ÙˆØ§Ø¬Ù† / ... ) === */
    .cat-grid{
      display:grid;
      grid-template-columns:repeat(2, minmax(0,1fr));
      gap:12px;
      margin:18px 0;
    }

    /* Ø´ÙˆÙŠØ© responsive ÙƒØ¯Ù‡ Ø¹Ø´Ø§Ù† Ø§Ù„Ø¯ÙŠØ³ÙƒØªÙˆØ¨ / Ø§Ù„ØªØ§Ø¨Ù„Øª */
    @media (min-width: 768px){
      .cat-grid{grid-template-columns:repeat(3, minmax(0,1fr));}
    }
    @media (min-width: 1024px){
      .cat-grid{grid-template-columns:repeat(4, minmax(0,1fr));}
    }
    .cat-card{background:#fff;border-radius:16px;border:1px solid var(--border);box-shadow:var(--shadow);
              padding:14px 10px;text-align:center;cursor:pointer;transition:.16s ease;transform:translateY(0);}
    .cat-card:hover{transform:translateY(-3px);}
    .cat-emoji{font-size:26px;margin-bottom:4px}
    .cat-title{font-weight:900;font-size:15px}

    .topRow{display:flex;align-items:center;justify-content:space-between;margin:10px 0 8px;gap:8px}
    .backBtn{background:#fff;color:#111;border:1px solid var(--border);border-radius:12px;padding:8px 10px;font-weight:700;cursor:pointer}
    .filterBtn{flex:1;background:#111827;color:#fff;border:none;border-radius:12px;padding:8px 10px;font-weight:700;cursor:pointer;font-size:14px}
    .filterBtn span{margin-inline-start:6px}

    /* === Ù„Ù…Ø³Ø© Ø¨Ø³ÙŠØ·Ø© Ø¹Ù„Ù‰ ÙƒÙ…ÙŠØ© Ø§Ù„ÙˆØ²Ù† ÙˆØ§Ù„Ø³Ù„Ø© === */
    .qty.is-weight{font-size:14px}
    .cartQty{display:flex;align-items:center;gap:4px;font-size:13px}
    .cartStep{width:26px;height:26px;border-radius:9px;border:1px solid var(--border);background:#fff;font-weight:900;cursor:pointer}

    /* === ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ (Mobile-first) === */
    @media (max-width: 768px){
      .hero-wrap{padding:14px 12px 8px}
      .hero h1{font-size:22px;line-height:1.4}
      .hero p{font-size:13px}
      .chip{font-size:12px;padding:4px 8px}

      .wrap{padding:0 10px 80px}
      .grid{grid-template-columns:repeat(2, minmax(0,1fr));gap:10px}
      .card{padding:8px;border-radius:14px}
      .plate{border-radius:14px}
      .name{font-size:14px}
      .desc{font-size:12px;min-height:auto}
      .row{margin-top:6px}
      .price{font-size:16px}
    }

    /* Ù„Ù…Ø§ ÙŠØ¨Ù‚Ù‰ ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: Ø§Ù„Ù‡ÙŠØ±Ùˆ ÙŠØ¨Ù‚Ù‰ Ø£Ø±ÙØ¹ */
    body.products-mode .hero-wrap{padding:10px 12px 4px}
    body.products-mode .hero p,
    body.products-mode .chip{display:none}
  
    /* === UI/UX v2 enhancements === */

    /* Hero actions & badges */
    .hero-actions{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:12px;
    }
    .hero-cta{
      background:#ffffff;
      color:var(--brand);
      box-shadow:0 6px 18px rgba(0,0,0,.18);
      border-radius:999px;
      padding-inline:18px;
      animation:ctaPulse 10s ease-in-out infinite;
    }
    .hero-secondary{
      border-color:rgba(255,255,255,.7);
      color:#fff;
      border-radius:999px;
    }
    .hero-badges{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:10px;
      font-size:11px;
    }
    .badge-pill{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.5);
      background:rgba(0,0,0,.08);
      white-space:nowrap;
    }

    /* Steps strip under hero */
    .steps-strip{
      background:#fff2f2;
      border-bottom:1px solid rgba(0,0,0,.02);
    }
    .steps-wrap{
      max-width:1200px;
      margin:0 auto;
      padding:8px 14px 14px;
      display:flex;
      flex-direction: column;
      gap:10px;
      overflow-x:auto;
    }
    .steps-item{
      flex:0 0 auto;
      min-width:220px;
      display:flex;
      align-items:flex-start;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      background:#ffffff;
      box-shadow:0 4px 14px rgba(0,0,0,.06);
    }
    .steps-icon{
      width:26px;
      height:26px;
      border-radius:999px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:var(--brand-d);
      color:#fff;
      font-size:13px;
      font-weight:900;
    }
    .steps-text{
      font-size:13px;
    }
    .steps-text strong{
      display:block;
      margin-bottom:2px;
    }

    /* Trust block */
    .trust{
      margin:30px 0 90px;
    }
    .trust-wrap{
      max-width:1200px;
      margin:0 auto;
      padding:0 14px;
    }
    .trust-title{
      margin:0 0 12px;
      font-size:20px;
      font-weight:900;
    }
    .trust-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:12px;
    }
    .trust-card{
      background:#ffffff;
      border-radius:16px;
      border:1px solid var(--border);
      padding:12px 10px;
      display:flex;
      align-items:flex-start;
      gap:10px;
      box-shadow:0 4px 16px rgba(0,0,0,.05);
    }
    .trust-icon{
      width:36px;
      height:36px;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#fff2f2;
      font-size:18px;
    }
    .trust-text h3{
      margin:0 0 4px;
      font-size:15px;
    }
    .trust-text p{
      margin:0;
      font-size:13px;
      color:var(--muted);
    }
    .trust-foot{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:14px;
    }
    .trust-chip{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff8f8;
    }

    /* Orderbar richer layout */
    .order-info{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width:0;
      flex:1;
    }
    .order-steps{
      display:flex;
      align-items:center;
      gap:6px;
      font-size:12px;
      opacity:.95;
    }
    .order-steps-pill{
      width:20px;
      height:20px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.6);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:11px;
      font-weight:800;
      background:rgba(0,0,0,.15);
    }
    .order-meta{
      display:flex;
      gap:10px;
      font-size:13px;
      opacity:.9;
    }

    /* Clamp descriptions & meta */
    .desc{
      color:var(--muted);
      font-size:13px;
      min-height:34px;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
      overflow:hidden;
    }
    .desc.desc-muted{
      opacity:.9;
    }
    .unitNote{
      font-size:11px;
      color:var(--muted);
      margin-top:2px;
    }
    .meta-line{
      margin-top:6px;
      font-size:11px;
      color:var(--muted);
    }

    .logo-badge {position: absolute;width:20%; top:20px;left:20px;z-index: 9999;}

    /* Stronger cards + cats hover & mobile scroller */
    .card{
      transition:transform .18s ease, box-shadow .18s ease;
      position: relative;
    }
    .card:hover{
      transform:translateY(-4px);
      box-shadow:0 12px 30px rgba(0,0,0,.14);
    }
    .cat-card{
      transition:transform .18s ease, box-shadow .18s ease;
    }
    .cat-card:hover{
      transform:translateY(-3px);
      box-shadow:0 10px 24px rgba(0,0,0,.12);
    }
    @media (max-width:720px){
      .steps-wrap{
        padding-bottom:10px;
      }
      .trust-wrap{
        padding-inline:12px;
      }
      .cat-grid{
        /* display:flex; */
        overflow-x:auto;
        gap:10px;
        padding-bottom:6px;
        margin-bottom:6px;
        scroll-snap-type:x mandatory;
      }
      .cat-card{
        min-width:130px;
        scroll-snap-align:start;
      }
    }

    /* Reveal-on-scroll animation */
    .reveal{
      opacity:0;
      transform:translateY(12px);
      transition:opacity .45s ease, transform .45s ease;
    }
    .reveal.reveal-show{
      opacity:1;
      transform:translateY(0);
    }

    /* Hero pattern + CTA gentle motion */
    .pattern{
      animation:heroFloat 18s ease-in-out infinite alternate;
    }
    @keyframes heroFloat{
      0%{transform:translate3d(0,0,0);}
      50%{transform:translate3d(-6px,4px,0);}
      100%{transform:translate3d(4px,-8px,0);}
    }
    @keyframes ctaPulse{
      0%,80%,100%{transform:translateY(0) scale(1);}
      85%{transform:translateY(-1px) scale(1.01);}
      90%{transform:translateY(0) scale(1.005);}
    }

    /* WhatsApp button in header */
    #wa.btn{
      background:#22c55e;
      color:#ffffff;
    }
    #wa.btn:hover{
      background:#16a34a;
      color:#ffffff;
    }

    .order-note{
      font-size:11px;
      opacity:.9;
      white-space:nowrap;
    }
</style>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="logo"><img id="logo" alt="Ø´Ø¹Ø§Ø± Ø·Ù†Ø· ÙƒÙˆÙƒÙŠ" loading="lazy"></div>
      <div class="brand">Ø·Ù†Ø· ÙƒÙˆÙƒÙŠ â€” Ø§Ù„Ù„Ø­ÙˆÙ… ÙˆØ§Ù„Ù…Ø¬Ù…Ø¯Ø§Øª</div>
      <div class="spacer"></div>
      <a id="tel" class="btn ghost" href="#">Ø§ØªØµØ§Ù„</a>
      <a id="wa" class="btn" target="_blank" rel="noopener">ÙˆØ§ØªØ³Ø§Ø¨</a>
    </div>
  </header>

  <section class="hero">
    <div class="pattern" aria-hidden="true"></div>
    <div class="hero-wrap" data-reveal>
      <h1>Ø·Ù†Ø· ÙƒÙˆÙƒÙŠ ,,, Ø·Ø¨Ø®ØªÙƒ Ø¹Ù„ÙŠÙ†Ø§.</h1>
      <p>Ø¨Ø¨Ø³Ø§Ø·Ø©: Ø¯ÙˆØ³ÙŠ "Ø£Ø¶Ù" â€“ Ø²ÙˆÙ‘Ø¯ÙŠ Ø£Ùˆ Ù‚Ù„Ù‘Ù„ÙŠ â€“ ÙˆØ¨Ø¹Ø¯Ù‡Ø§ "Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨".</p>
      <span class="chip">Ù„Ø§ Ø³Ù„Ø© Ù…Ø¹Ù‚Ø¯Ø© â€¢ Ù„Ø§ ØªØ³Ø¬ÙŠÙ„ â€¢ ÙƒÙ„Ù‡ Ø³Ø±ÙŠØ¹</span>
      <div class="hero-actions">
        <button class="btn hero-cta" id="heroStart">Ø§Ø¨Ø¯Ø£ÙŠ Ø§Ù„Ø·Ù„Ø¨ Ø¯Ù„ÙˆÙ‚ØªÙŠ</button>
        <button class="btn ghost hero-secondary" id="quickHelp">Ù…Ø´ ÙØ§Ø¶ÙŠØ© Ø£Ù„Ù ÙƒØªÙŠØ±ØŸ</button>
      </div>
      <div class="hero-badges">
        <span class="badge-pill">ØªÙˆØµÙŠÙ„ Ù„Ø£ÙŠ Ù…ÙƒØ§Ù†</span>
        <span class="badge-pill">Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</span>
      </div>
    </div>
  </section>

  <section class="steps-strip">
    <div class="wrap steps-wrap">
      <div class="steps-item" data-reveal>
        <div class="steps-icon">Ù¡</div>
        <div class="steps-text">
          <strong>Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù‚Ø³Ù…</strong>
          <span>Ù„Ø­ÙˆÙ…ØŒ Ø¯ÙˆØ§Ø¬Ù†ØŒ Ø£Ø³Ù…Ø§Ùƒ Ø£Ùˆ Ù…Ø¬Ù…Ø¯Ø§Øª.</span>
        </div>
      </div>
      <div class="steps-item" data-reveal>
        <div class="steps-icon">Ù¢</div>
        <div class="steps-text">
          <strong>Ø²ÙˆÙ‘Ø¯ÙŠ Ø£Ùˆ Ù‚Ù„Ù‘Ù„ÙŠ Ø§Ù„ÙƒÙ…ÙŠØ©</strong>
          <span>ÙƒÙ„ Ø¶ØºØ·Ø© ØªØ²ÙˆØ¯ Ø£Ùˆ ØªÙ†Ù‚Øµ Ø§Ù„ÙƒÙ…ÙŠØ© Ø¨Ø§Ù„ÙƒÙŠÙ„Ùˆ Ø£Ùˆ Ø¨Ø§Ù„Ù‚Ø·Ø¹Ø©.</span>
        </div>
      </div>
      <div class="steps-item" data-reveal>
        <div class="steps-icon">Ù£</div>
        <div class="steps-text">
          <strong>Ø§Ø¨Ø¹ØªÙŠ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨</strong>
          <span>Ù…Ù† ØºÙŠØ± ØªØ³Ø¬ÙŠÙ„ ÙˆÙ„Ø§ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹Ù‚Ø¯Ø©ØŒ ÙˆØ§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù….</span>
        </div>
      </div>
    </div>
  </section>

  <div class="wrap">
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div id="catsView" class="cat-grid"></div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
    <div id="productsView" class="hidden">
      <div class="topRow">
        <button id="backCats" class="backBtn">â¬… ÙƒÙ„ Ø§Ù„Ø£ØµÙ†Ø§Ù</button>
        <button id="filtersBtn" class="filterBtn">
          ğŸ” <span>Ø¹Ø§ÙŠØ²Ø© ØªØ¯ÙˆØ±ÙŠ Ø¹Ù„Ù‰ Ø­Ø§Ø¬Ø© Ù…Ø¹ÙŠÙ†Ø©ØŸ</span>
        </button>
      </div>

      <div id="filtersPanel" class="toolbar hidden" role="region" aria-label="Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¨Ø­Ø«">
        <input id="q" class="search" type="search" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø­Ø§Ø¬Ø© Ù‡Ù†Ø§...">
        <select id="cat" class="select"><option value="">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option></select>
        <select id="brand" class="select"><option value="">ÙƒÙ„ Ø§Ù„Ø´Ø±ÙƒØ§Øª</option></select>
        <input id="min" class="input" type="number" inputmode="numeric" placeholder="Ø£Ù‚Ù„ Ø³Ø¹Ø±">
        <input id="max" class="input" type="number" inputmode="numeric" placeholder="Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±">
        <label class="switch"><input id="offersOnly" type="checkbox"> Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø¨Ø³</label>
        <label class="switch"><input id="onlyAvailable" type="checkbox" checked> Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø³</label>
        <button id="reload" class="reload">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
      </div>

      <div id="grid" class="grid" aria-live="polite"></div>
      <div id="empty" class="empty" style="display:none">Ù…ÙÙŠØ´ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©.</div>
    </div>
  </div>

  <div class="orderbar" id="orderbar" style="display:none">
    <div class="order-info">
      <div class="order-steps">
        <span class="order-steps-pill">Ù¢</span>
        <span class="order-steps-text">Ø±Ø§Ø¬Ø¹ÙŠ Ø·Ù„Ø¨Ùƒ ÙˆØ¨Ø¹Ø¯ÙŠÙ† Ø§Ø¨Ø¹ØªÙŠÙ‡ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨</span>
      </div>
      <div class="order-meta">
        <div class="count" id="orderCount">0 ØµÙ†Ù</div>
        <div class="total" id="orderTotal">â€”</div>
        <div class="order-note">ğŸ’µ Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</div>
      </div>
    </div>
    <div class="order-actions">
      <button class="go" id="sendWA">Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨</button>
      <button class="cartbtn" id="toggleDrawer">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø®ØªØ§Ø±</button>
      <button class="clear" id="clearSel">Ù…Ø³Ø­</button>
    </div>
  </div>

  <canvas class="confetti" id="confetti" width="0" height="0"></canvas>

  <!-- === Drawer preview === -->
  <aside id="drawer" class="drawer" aria-live="polite">
    <div class="drawer-header">
      <h3>Ø§Ø®ØªÙŠØ§Ø±Ø§ØªÙƒ</h3>
      <button id="closeDrawer" class="drawer-close" aria-label="Ø¥ØºÙ„Ø§Ù‚">Ã—</button>
    </div>
    <ul id="cartList" class="cartlist"></ul>
  </aside>

  <!-- === Checkout modal === -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true">
    <div class="modal pop">
      <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„ØªØ³Ù„ÙŠÙ…</h3>
      <div class="formrow">
        <label>Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù„Ù„ØªÙˆØ§ØµÙ„</label>
        <input id="custPhone" type="tel" inputmode="tel" placeholder="Ù…Ø«Ø§Ù„: 0100xxxxxxx">
      </div>
      <div class="formrow">
        <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„</label>
        <textarea id="custAddr" rows="3" placeholder="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©ØŒ Ø§Ù„Ø´Ø§Ø±Ø¹ØŒ Ø±Ù‚Ù… Ø§Ù„Ø¨ÙŠØª/Ø§Ù„Ø¯ÙˆØ±/Ø¹Ù„Ø§Ù…Ø© Ù…Ù…ÙŠØ²Ø©â€¦"></textarea>
      </div>
      <div class="mfoot">
        <button class="cancel" id="closeModal">Ø¥Ù„ØºØ§Ø¡</button>
        <button class="ok" id="confirmSend">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</button>
      </div>
    </div>
  </div>

  <section class="trust">
    <div class="wrap trust-wrap">
      <h2 class="trust-title" data-reveal>Ù„ÙŠÙ‡ Ø·Ù†Ø· ÙƒÙˆÙƒÙŠØŸ</h2>
      <div class="trust-grid">
        <article class="trust-card" data-reveal>
          <div class="trust-icon">ğŸ¥©</div>
          <div class="trust-text">
            <h3>Ù„Ø­ÙˆÙ… Ø·Ø§Ø²Ø© ÙˆÙ…ØªØ¬Ø±Ø¨Ø©</h3>
            <p>ÙƒÙ„ Ù‚Ø·Ø¹Ø© Ù…ØªØ±Ø§Ø¬ÙØ¹Ø© ÙƒÙˆÙŠØ³ ÙˆÙ…Ø®ØªØ§Ø±Ø© Ø¹Ù„Ù‰ Ù…Ø²Ø§Ø¬ Ø³Øª Ø§Ù„Ø¨ÙŠØª Ø§Ù„Ù…ØµØ±ÙŠØ©.</p>
          </div>
        </article>
        <article class="trust-card" data-reveal>
          <div class="trust-icon">ğŸ“¦</div>
          <div class="trust-text">
            <h3>ØªØºÙ„ÙŠÙ ÙˆØªØ®Ø²ÙŠÙ† Ø¢Ù…Ù†</h3>
            <p>ØªØºÙ„ÙŠÙ Ù…Ø­ÙƒÙ… ÙŠÙ†Ø§Ø³Ø¨ Ø§Ù„ØªØ¬Ù…ÙŠØ¯ ÙˆØ§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„ÙØ±ÙŠØ²Ø± Ø¨Ø¯ÙˆÙ† ÙˆØ¬Ø¹ Ø¯Ù…Ø§Øº.</p>
          </div>
        </article>
        <article class="trust-card" data-reveal>
          <div class="trust-icon">ğŸšš</div>
          <div class="trust-text">
            <h3>ØªÙˆØµÙŠÙ„ Ù„Ø­Ø¯ Ø¨Ø§Ø¨ Ø§Ù„Ø¨ÙŠØª</h3>
            <p>Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…ØŒ ÙˆØ§ØªØ³Ø§Ø¨ Ø£Ùˆ Ù…ÙƒØ§Ù„Ù…Ø©â€¦ Ø§Ù„Ù„ÙŠ ÙŠØ±ÙŠØ­Ùƒ.</p>
          </div>
        </article>
      </div>
      <div class="trust-foot" data-reveal>
        <span class="trust-chip">Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</span>
        <span class="trust-chip">Ù…ÙÙŠØ´ ØªØ³Ø¬ÙŠÙ„</span>
        <span class="trust-chip">ÙˆØ§ØªØ³Ø§Ø¨ Ø¯Ø§ÙŠÙ…Ù‹Ø§ Ø´ØºØ§Ù„</span>
      </div>
    </div>
  </section>

  <script>
    const ASSETS = {
      LOGO_URL: "./logo.jpg",
      PATTERN_URL: "./pattern.svg",
      WHATSAPP_PHONE: "201551846461", // Ù…Ø«Ø§Ù„: 201551846461
      CALL_PHONE: "01060682224"
    };
     const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRBz_5SuMZ0KwWDN5v_gLCo-RuRonyc0oW__QkWeTQPUjP-AG1vZVt_FHF9_trMYxIT6LdE-765_aV8/pub?gid=372316673&single=true&output=csv";

    let CURRENT_CATEGORY = ""; // Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù„ÙŠ Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ§Ù‚Ù ÙÙŠÙ‡

    const el = id => document.getElementById(id);
    const unique = a => [...new Set(a)].filter(Boolean);
    const parseBool = v => (v ?? "").toString().trim().toLowerCase() === "true";
    function formatPrice(n){ if(n==null||isNaN(n)) return ""; return new Intl.NumberFormat('ar-EG',{maximumFractionDigits:2}).format(n)+" Ø¬.Ù…" }
    function escapeHtml(s){ return (s ?? "").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m])) }
    const hasOffer = p => p.sale_price && p.price && p.sale_price < p.price;
    const isByWeight = p => parseBool(p.by_weight); // TRUE = Ø¨Ø§Ù„ÙˆØ²Ù†
    const stepFor   = p => isByWeight(p) ? 0.25 : 1; // Ø±Ø¨Ø¹ ÙƒÙŠÙ„Ùˆ Ù„ÙƒÙ„ Ø¶ØºØ·Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹

    function csvToObjects(csv){
      const rows=[]; let field="",row=[],q=false;
      const pushF=()=>{row.push(field); field=""}; const pushR=()=>{rows.push(row); row=[]};
      for(const c of csv){ if(c=='"'){q=!q} else if(c==','&&!q){pushF()} else if(c=='\n'&&!q){pushF();pushR()} else {field+=c} }
      if(field||row.length){pushF();pushR()}
      const headers=(rows.shift()||[]).map(h=>h.trim());
      return rows
        .filter(r=>r.some(x=>(x||"").trim()!==""))
        .map((r,idx)=>{
          const o={}; headers.forEach((h,i)=>o[h]=(r[i]??"").trim());
          // uid Ø¯Ø§Ø®Ù„ÙŠ ÙØ±ÙŠØ¯ Ù„ÙƒÙ„ Ù…Ù†ØªØ¬ (Ø­ØªÙ‰ Ù„Ùˆ id ÙØ§Ø¶ÙŠ Ø£Ùˆ Ù…ÙƒØ±Ø±)
          const keySource = (
            o.id ||
            o.sku ||
            o.barcode ||
            `${o.name}|${o.unit}` ||
            ""
          ).toString();
          o._uid = keySource.trim() || `row-${idx+1}`;

          o.price=o.price?Number(o.price):null; o.sale_price=o.sale_price?Number(o.sale_price):null;
          const rawInStock = o.in_stock;
          // Ù„Ùˆ Ø§Ù„Ø®Ø§Ù†Ø© ÙØ§Ø¶ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯ â†’ Ø§Ø¹ØªØ¨Ø±Ù‡ Ù…ØªÙˆÙØ± Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§
          o.in_stock = (rawInStock == null || rawInStock === "") ? true : parseBool(rawInStock);
          o.is_new=parseBool(o.is_new); o.is_featured=parseBool(o.is_featured);
          o.by_weight=parseBool(o.by_weight); // TRUE Ù„Ùˆ Ø§Ù„ØµÙ†Ù Ø¨ÙŠØªØ¨Ø§Ø¹ Ø¨Ø§Ù„ÙˆØ²Ù† (ÙƒÙŠÙ„Ùˆ/Ø¬Ø±Ø§Ù…)
          o.tags=(o.tags||"").split("|").map(s=>s.trim()).filter(Boolean);
          return o;
      })
    }

    // Identity
    document.getElementById("logo").src = ASSETS.LOGO_URL;
    document.documentElement.style.setProperty("--pattern-url", `url('${ASSETS.PATTERN_URL}')`);
    document.getElementById("tel").href = `tel:${ASSETS.CALL_PHONE}`;
    document.getElementById("wa").href = `https://wa.me/${ASSETS.WHATSAPP_PHONE}`;

     // Selection
    const SEL = new Map();
    const keyFor = (p) => p._uid || p.id || p.name; // Ù…ÙØªØ§Ø­ Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„Ø³Ù„Ø©

    function addItem(p){
      const key  = keyFor(p);
      const step = stepFor(p);
      const cur  = SEL.get(key) || {qty:0,p};
      cur.qty    = +(cur.qty + step).toFixed(2);
      SEL.set(key,{qty:cur.qty,p});
      bounceBar(); updateUI();
    }
    function decItem(p){
      const key  = keyFor(p);
      const step = stepFor(p);
      const cur  = SEL.get(key); if(!cur) return;
      cur.qty    = +(cur.qty - step).toFixed(2);
      if(cur.qty <= 0){ SEL.delete(key); } else { SEL.set(key,cur); }
      updateUI();
    }
    function getTotals(){
      let count=0,total=0;
      for(const {qty,p} of SEL.values()){
        count+=qty;
        const per=hasOffer(p)?p.sale_price:p.price;
        total+=(per||0)*qty;
      }
      return {count,total};
    }
    let lastCount = 0;
    let barBounceTimer = null;

    function bounceBar(){
      const ob = el("orderbar");
      if(!ob) return;
      ob.classList.remove("pulse");
      void ob.offsetWidth; // restart animation
      ob.classList.add("pulse");
    }

     // ØªØ´ØºÙŠÙ„ Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø®ÙÙŠÙØ© ÙƒÙ„ Ø´ÙˆÙŠØ© Ø¹Ø´Ø§Ù† ØªÙÙƒØ± Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø§Ù„Ø³Ù„Ø©
    function ensureBarBounce(count){
      const bar = el("orderbar");
      if(!bar) return;
      if(count>0){
        if(!barBounceTimer){
          barBounceTimer = setInterval(()=>{
            if(SEL.size>0){ bounceBar(); }
          }, 2000); // ÙƒÙ„ ~7 Ø«ÙˆØ§Ù†ÙŠ
        }
      }else{
        if(barBounceTimer){
          clearInterval(barBounceTimer);
          barBounceTimer=null;
        }
        bar.classList.remove("pulse");
      }
    }

    function updateUI(){
      const {count,total}=getTotals();
      const bar=el("orderbar");

      if(count>0){
        bar.style.display="flex";
        el("orderCount").textContent=`${count} ØµÙ†Ù`;
        el("orderTotal").textContent=`Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${formatPrice(total)}`;
        if(count !== lastCount){ bounceBar(); } // bounce Ø¨Ø³ÙŠØ· ÙƒÙ„ Ù…Ø§ Ø§Ù„Ø¹Ø¯Ø¯ ÙŠØªØºÙŠØ±
      }else{
        bar.style.display="none";
      }
      lastCount = count;
      ensureBarBounce(count);
      // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± + / - ÙÙŠ ÙƒØ±ÙˆØª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
      document.querySelectorAll(".card[data-id]").forEach(card=>{
        const id=card.getAttribute("data-id");
        const state=SEL.get(id);
        const addBtn=card.querySelector(".add");
        const stepper=card.querySelector(".stepper");
        const qtyEl=card.querySelector(".qty");
        if(!addBtn || !stepper || !qtyEl) return;
        if(state){
          addBtn.style.display="none";
          stepper.classList.add("show");
          let label = state.qty;
          // Ù„Ùˆ Ø¹Ù†Ø¯Ùƒ Ø¯Ø¹Ù… "Ø¨Ø§Ù„ÙˆØ²Ù†" Ù‡ÙŠØ¨Ø§Ù† Ù‡Ù†Ø§ Ø¨ÙƒØ¬Ù…ØŒ ÙˆØ¥Ù„Ø§ Ù‡ÙŠØ´ØªØºÙ„ ÙƒØ¹Ø¯Ø¯ Ø¹Ø§Ø¯ÙŠ
          if(typeof isByWeight === "function" && isByWeight(state.p)){
            label = state.qty.toLocaleString('ar-EG',{maximumFractionDigits:2}) + " ÙƒØ¬Ù…";
          }
          qtyEl.textContent = label;
        }else{
          addBtn.style.display="block";
          stepper.classList.remove("show");
          qtyEl.textContent = "1";
        }
      });

      if(typeof renderDrawer === "function"){
        renderDrawer(); // Ø¯Ø§ Ø§Ù„Ù„ÙŠ Ø¨ÙŠØ®Ù„Ù‘ÙŠ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ ÙŠØªØ­Ø¯Ù‘Ø« Ù…Ø¹ ÙƒÙ„ ØªØºÙŠÙŠØ±
      }
    }

    // ÙƒÙˆÙ†ÙÙŠØªÙŠ Ù…Ø³ØªØ·ÙŠÙ„Ø§Øª Ø®ÙÙŠÙØ© Ø¨Ø¯Ù„ Ø¯ÙˆØ§ÙŠØ± ØªÙ‚ÙŠÙ„Ø©
    function confetti(){
      const c = el("confetti"), ctx = c.getContext("2d");
      c.width = innerWidth; c.height = innerHeight;
      const pieces = Array.from({length:60},()=>({
        x:Math.random()*c.width,
        y:-20,
        w:4+Math.random()*6,
        h:10+Math.random()*14,
        s:1+Math.random()*1.5,
        r:Math.random()*Math.PI,
        color:`hsl(${Math.random()*30+350},90%,60%)`
      }));
      let frames = 0;
      const id = setInterval(()=>{
        ctx.clearRect(0,0,c.width,c.height);
        pieces.forEach(p=>{
          p.y += p.s*2;
          p.x += Math.sin((p.y+frames)/25);
          p.r += 0.05;
          ctx.save();
          ctx.translate(p.x,p.y);
          ctx.rotate(p.r);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
          ctx.restore();
        });
        frames++;
        if(frames>120){
          clearInterval(id);
          ctx.clearRect(0,0,c.width,c.height);
        }
      },16);
    }

     function buildFilters(items){
      el("cat").innerHTML='<option value="">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>'+unique(items.map(i=>i.category)).map(c=>`<option>${escapeHtml(c)}</option>`).join("");
      el("brand").innerHTML='<option value="">ÙƒÙ„ Ø§Ù„Ø´Ø±ÙƒØ§Øª</option>'+unique(items.map(i=>i.company)).map(b=>`<option>${escapeHtml(b)}</option>`).join("");
    }

    // Ø§Ø®ØªÙŠØ§Ø± Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø­Ø³Ø¨ Ø§Ø³Ù… Ø§Ù„ÙØ¦Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ
    function emojiForCat(name){
      const n = (name || "").toString().toLowerCase();
      // Ù„Ø­ÙˆÙ…
      if(n.includes("Ù„Ø­Ù…") || n.includes("Ù„Ø­ÙˆÙ…") || n.includes("ÙƒÙ†Ø¯ÙˆØ²") || n.includes("Ø¨Ø±Ø§Ø²ÙŠÙ„ÙŠ")) return "ğŸ¥©";
      // Ø¯ÙˆØ§Ø¬Ù†
      if(n.includes("Ø¯ÙˆØ§Ø¬Ù†") || n.includes("ÙØ±Ø§Ø®") || n.includes("Ø¯Ø¬Ø§Ø¬")) return "ğŸ—";
      // Ø£Ø³Ù…Ø§Ùƒ / Ø¬Ù…Ø¨Ø±ÙŠ
      if(n.includes("Ø³Ù…Ùƒ") || n.includes("Ø£Ø³Ù…Ø§Ùƒ") || n.includes("Ø¨Ø­Ø±ÙŠ") || n.includes("Ø¬Ù…Ø¨Ø±ÙŠ")) return "ğŸŸ";
      // Ø®Ø¶Ø§Ø±
      if(n.includes("Ø®Ø¶Ø§Ø±") || n.includes("Ø®Ø¶Ø±ÙˆØ§Øª")) return "ğŸ¥¦";
      // Ø²ÙŠÙˆØª / Ø³Ù…Ù†Ø©
      if(n.includes("Ø²ÙŠØª") || n.includes("Ø²ÙŠÙˆØª") || n.includes("Ø³Ù…Ù†")) return "ğŸ«™";
      // Ù…ÙƒØ±ÙˆÙ†Ø©
      if(n.includes("Ù…ÙƒØ±ÙˆÙ†Ø©") || n.includes("Ù…ÙƒØ±ÙˆÙ†Ø§Øª") || n.includes("Ù…Ø¹ÙƒØ±ÙˆÙ†Ø©")) return "ğŸ";
      // ØµÙ„ØµØ© / ØµÙˆØµ
      if(n.includes("ØµÙ„ØµØ©") || n.includes("ØµÙˆØµ") || n.includes("ÙƒØ§ØªØ´Ø¨") || n.includes("Ø·Ù…Ø§Ø·Ù…")) return "ğŸ…";
      // Ø¹Ø³Ù„
      if(n.includes("Ø¹Ø³Ù„")) return "ğŸ¯";
      // Ø¨ÙŠØ¶
      if(n.includes("Ø¨ÙŠØ¶")) return "ğŸ¥š";
      // Ø£Ø¬Ø¨Ø§Ù†
      if(n.includes("Ø¬Ø¨Ù†") || n.includes("Ø¬Ø¨Ù†Ø©")) return "ğŸ§€";
      // Ù…Ø¬Ù…Ø¯Ø§Øª Ø¹Ø§Ù…Ø©
      if(n.includes("Ù…Ø¬Ù…Ø¯Ø§Øª") || n.includes("ÙØ±ÙˆØ²Ù†")) return "â„ï¸";
      // Ø£ØµÙ†Ø§Ù Ø£Ø®Ø±Ù‰ / Ù…Ù†ÙˆØ¹Ø§Øª
      if(n.includes("Ø£ØµÙ†Ø§Ù") || n.includes("Ù…Ù†ÙˆØ¹") || n.includes("Ø§Ø®Ø±Ù‰") || n.includes("Ø£Ø®Ø±Ù‰")) return "ğŸ§º";
      // Ø£ÙŠ ÙØ¦Ø© Ù…Ø´ Ù…Ø¹Ø±ÙˆÙØ©
      return "ğŸ›’";
    }

    function buildCats(items){
      const cats = unique(items.map(i=>i.category));
      const holder = el("catsView");
      holder.innerHTML = cats.map((c)=>{
        const emoji = emojiForCat(c);
        return `<button class="cat-card" data-reveal data-cat="${escapeHtml(c)}">
                  <div class="cat-emoji">${emoji}</div>
                  <div class="cat-title">${escapeHtml(c)}</div>
                </button>`;
      }).join("");
      holder.querySelectorAll(".cat-card").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          CURRENT_CATEGORY = btn.getAttribute("data-cat") || "";
          el("cat").value = CURRENT_CATEGORY;
          showProductsView();
          applyFilters(window.__ALL__ || []);
        });
      });
    }

    function showProductsView(){
      el("catsView").classList.add("hidden");
      el("productsView").classList.remove("hidden");
      document.body.classList.add("products-mode");   // Ø§Ù„Ù‡ÙŠØ±Ùˆ ÙŠØ¨Ù‚Ù‰ Ø£Ø±ÙØ¹
    }
    function showCatsView(){
      el("productsView").classList.add("hidden");
      el("catsView").classList.remove("hidden");
      document.body.classList.remove("products-mode"); // Ù†Ø±Ø¬Ø¹Ù‡ ÙƒØ§Ù…Ù„ ØªØ§Ù†ÙŠ
    }

    const SAMPLE_CSV = `id,name,category,company,unit,price,sale_price,in_stock,image_url,description,tags,weight_g,sku,barcode,is_featured,is_new,updated_at
1001,ÙƒØ¨Ø¯Ø© Ø¨Ù„Ø¯ÙŠ,Ù„Ø­ÙˆÙ… Ø·Ø§Ø²Ø¬Ø©,Ø¨Ù„Ø¯ÙŠ,ÙƒØ¬Ù…,380,,TRUE,,Ø·Ø§Ø²Ø¬Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§,"ÙƒØ¨Ø¯Ø©|Ø¨Ù„Ø¯ÙŠ",1000,KBD-01,,TRUE,TRUE,2025-11-05
1002,Ù„Ø­Ù…Ø© Ù…ÙØ±ÙˆÙ…Ø© Ù…Ù…ØªØ§Ø²,Ù„Ø­ÙˆÙ… Ø·Ø§Ø²Ø¬Ø©,Ù…ÙØ±ÙˆÙ…,ÙƒØ¬Ù…,420,390,TRUE,,Ù…ÙØ±ÙˆÙ…Ø© Ø¬Ø§Ù‡Ø²Ø©,"Ù…ÙØ±ÙˆÙ…|Ù„Ø­Ù…Ø©",1000,LMF-02,,TRUE,FALSE,2025-11-04
1003,Ø¨Ø§Ù†ÙŠÙ‡ ÙØ±Ø§Ø®,Ø¯ÙˆØ§Ø¬Ù†,Ø´Ø±ÙƒØ§Øª,ÙƒØ¬Ù…,230,199,TRUE,,ØµØ¯ÙˆØ± Ù…ØªØ¨Ù„Ø©,"ÙØ±Ø§Ø®|Ø¨Ø§Ù†ÙŠÙ‡|Ø¹Ø±Ø¶",1000,BAN-33,,FALSE,TRUE,2025-11-06`;

    
    
    function render(items){
      const grid = el("grid"), empty = el("empty");
      if(!grid || !empty) return;

      if(!items.length){
        grid.innerHTML = "";
        empty.style.display = "block";
        return;
      }

      empty.style.display = "none";

      grid.innerHTML = items.map(p=>{
        const badge = !p.in_stock
          ? '<div class="badge oos">Ù†ÙØ¯Øª</div>'
          : (hasOffer(p)
              ? '<div class="badge offer">Ø¹Ø±Ø¶</div>'
              : (p.is_new ? '<div class="badge new">Ø¬Ø¯ÙŠØ¯</div>' : '')
            );

        const priceHtml = hasOffer(p)
          ? `<span class="price">${formatPrice(p.sale_price)}</span><span class="old">${formatPrice(p.price)}</span>`
          : `<span class="price">${formatPrice(p.price)}</span>`;

        const unitLabel = isByWeight(p)
          ? 'Ù„ÙƒÙ„ ÙƒØ¬Ù…'
          : (p.unit || '').trim()
            ? `Ù„ÙƒÙ„ ${escapeHtml(p.unit)}`
            : '';

        const unitHtml = unitLabel
          ? `<div class="unitNote">${unitLabel}</div>`
          : '';

        const brand = p.company
          ? `<span class="brandTag">${escapeHtml(p.company)}</span>`
          : "";

        const img = p.image_url
          ? `<img loading="lazy" src="${escapeHtml(p.image_url)}" alt="${escapeHtml(p.name)}">`
          : "";

        const desc = (p.description || "").trim();
        const descHtml = desc
          ? `<div class="desc">${escapeHtml(desc)}</div>`
          : `<div class="desc desc-muted">Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¶Ù…ÙˆÙ† Ù…Ù† Ø·Ù†Ø· ÙƒÙˆÙƒÙŠ.</div>`;

        const updated = p.updated_at
          ? `<div class="meta-line">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${escapeHtml(p.updated_at)}</div>`
          : "";

        const disabled = (!p.in_stock) ? "disabled" : "";

        return `<article class="card" data-reveal data-id="${escapeHtml(p._uid)}">
          <img src="./logo-badge.png" class="logo-badge" loading="lazy">
          <div class="plate">${badge}${img}</div>
          <div class="name">${escapeHtml(p.name||"")}</div>
          ${descHtml}
          <div class="row">
            <div>
              ${priceHtml}
              ${unitHtml}
            </div>
            <div>${brand}</div>
          </div>
          ${updated}
          <div class="choose">
            <button class="add" ${disabled}>Ø£Ø¶Ù</button>
            <div class="stepper">
              <button class="step" data-act="dec">â€“</button>
              <div class="qty">1</div>
              <button class="step" data-act="inc">+</button>
            </div>
          </div>
        </article>`;
      }).join("");

      grid.querySelectorAll(".card").forEach(card=>{
        const id = card.getAttribute("data-id");
        const p = (items || []).find(x => x._uid === id);
        if(!p) return;

        const addBtn = card.querySelector(".add");
        const stepper = card.querySelector(".stepper");

        if(addBtn){
          addBtn.addEventListener("click", ()=>{
            if(!p.in_stock) return;
            addItem(p);
          });
        }

        if(stepper){
          stepper.querySelectorAll(".step").forEach(btn=>{
            btn.addEventListener("click", ()=>{
              const act = btn.getAttribute("data-act");
              if(act === "inc"){
                addItem(p);
              }else if(act === "dec"){
                decItem(p);
              }
            });
          });
        }
      });

      // ØªØ£ÙƒÙŠØ¯ Ø¥Ù† Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø´ØºØ§Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
      if(typeof setupRevealAnimations === "function"){
        setupRevealAnimations();
      }

      // Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø´Ø±ÙŠØ· ÙˆØ§Ù„Ø³Ù„Ø© Ø¨Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±Ø³Ù…
      if(typeof updateUI === "function"){
        updateUI();
      }
    }

    // Ù†ÙØ³ Ù„ÙˆØ¬ÙŠÙƒ Ø§Ù„ÙÙ„ØªØ±Ø© Ù…Ù† Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
function applyFilters(all){
  const q      = el("q").value.toLowerCase().trim();
  const cat    = el("cat").value;
  const brand  = el("brand").value;
  const min    = Number(el("min").value || 0);
  const max    = Number(el("max").value || 0);
  const only   = el("onlyAvailable").checked;
  const offersOnly = el("offersOnly").checked;

  let list = all.filter(p=>{
    if(only && !p.in_stock) return false;
    if(offersOnly && !hasOffer(p)) return false;
    if(cat && p.category !== cat) return false;
    if(brand && p.company !== brand) return false;

    const price = hasOffer(p) ? p.sale_price : p.price;
    if(min && price < min) return false;
    if(max && price > max) return false;

    // tags Ø¹Ù†Ø¯Ù†Ø§ Ø£Ø­ÙŠØ§Ù†Ù‹Ø§ Ø¨ØªØ¨Ù‚Ù‰ Array ÙˆØ£Ø­ÙŠØ§Ù†Ù‹Ø§ String
    const tagsStr = Array.isArray(p.tags) ? p.tags.join(" ") : (p.tags || "");
    const hay = (
      (p.name || "") + " " +
      (p.description || "") + " " +
      tagsStr + " " +
      (p.company || "")
    ).toLowerCase();

    if(q && !hay.includes(q)) return false;
    return true;
  });

  list.sort((a,b)=>{
    if(a.in_stock !== b.in_stock) return a.in_stock ? -1 : 1;
    if(hasOffer(a) !== hasOffer(b)) return hasOffer(a) ? -1 : 1;
    if(a.is_featured !== b.is_featured) return a.is_featured ? -1 : 1;
    return (a.name||"").localeCompare(b.name||"", 'ar');
  });

  render(list);
}
function buildOrderId(){
      const d=new Date();
      const pad=n=>String(n).padStart(2,'0');
      return `TKK-${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}-${pad(d.getHours())}${pad(d.getMinutes())}${pad(d.getSeconds())}`;
    }
    function buildWAText(meta){
      const orderId = buildOrderId();
      let lines=[`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ (#${orderId})`]; let total=0,count=0;
      for(const {qty,p} of SEL.values()){
        const per=hasOffer(p)?p.sale_price:p.price; const sub=(per||0)*qty;
        total+=sub; count+=qty;
        const qtyLabel = isByWeight(p)
          ? `${qty.toLocaleString('ar-EG',{maximumFractionDigits:2})} ÙƒØ¬Ù…`
          : `${qty} Ù‚Ø·Ø¹Ø©`;
        lines.push(`â€¢ ${qtyLabel} Ù…Ù† ${p.name} ${p.unit?`(${p.unit})`:""} â€” ${per} = ${sub} Ø¬.Ù…`);
      }
      lines.push(`Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} Ø¬.Ù…`); lines.push(`Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ â¤ï¸`);
      if(meta){
        lines.push("");
        lines.push(`Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„: ${meta.phone}`);
        lines.push(`Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${meta.addr}`);
      }
      return { text: lines.join("\n"), orderId };
    }
     // Drawer preview
    const drawer = el("drawer");
     function renderDrawer(){
      const list = el("cartList");
      list.innerHTML = "";
      for(const {qty,p} of SEL.values()){
        const per = hasOffer(p)?p.sale_price:p.price;
        const sub = (per||0)*qty;
        const niceQty =
          (typeof isByWeight === "function" && isByWeight(p))
            ? qty.toLocaleString('ar-EG',{maximumFractionDigits:2}) + " ÙƒØ¬Ù…"
            : qty + " Ù‚Ø·Ø¹Ø©";
        const li = document.createElement("li");
        li.innerHTML = `
          <div>
            <strong>${escapeHtml(p.name)}</strong>
            <div class="meta">${escapeHtml(p.unit||"")} â€¢ ${per} Ø¬.Ù…</div>
          </div>
          <div class="cartQty">
            <button class="cartStep" data-act="dec" data-id="${p._uid}">-</button>
            <span>${niceQty} = ${sub}</span>
            <button class="cartStep" data-act="inc" data-id="${p._uid}">+</button>
          </div>`;
        list.appendChild(li);
      }

      // Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± + / - Ø¬ÙˆÙ‘Ù‡ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ù†ÙØ³Ù‡
      list.querySelectorAll(".cartStep").forEach(btn=>{
        const act = btn.getAttribute("data-act");
        const id  = btn.getAttribute("data-id");
        const st  = SEL.get(id);
        if(!st) return;
        btn.onclick = ()=> act==="inc" ? addItem(st.p) : decItem(st.p);
      });
    }
    el("toggleDrawer").addEventListener("click", ()=> drawer.classList.toggle("show"));
    el("closeDrawer").addEventListener("click", ()=> drawer.classList.remove("show"));

    // Modal flow
    const overlay = el("overlay");
    el("sendWA").addEventListener("click", ()=>{
      if(SEL.size===0) return;
      overlay.classList.add("show");
      el("custPhone").focus();
    });
    el("closeModal").addEventListener("click", ()=> overlay.classList.remove("show"));
    el("confirmSend").addEventListener("click", ()=>{
      const phone = el("custPhone").value.trim();
      const addr  = el("custAddr").value.trim();
      if(!phone || !addr){ alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„."); return; }
      const { text } = buildWAText({ phone, addr });
      const url=`https://wa.me/${ASSETS.WHATSAPP_PHONE}?text=${encodeURIComponent(text)}`;
      overlay.classList.remove("show");
      window.location.href=url;
    });
    el("clearSel").addEventListener("click", ()=>{ SEL.clear(); updateUI() });

    async function fetchCSVText(url){
      const useSample = !url || url.includes("PLACEHOLDER");
      if(useSample){ await new Promise(r=>setTimeout(r,60)); return SAMPLE_CSV; }
      const res = await fetch(url, { cache:"no-store" });
      if(!res.ok) throw new Error("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ CSV");
      return await res.text();
    }
    
    function setupHeroActions(){
      const heroStart = document.getElementById("heroStart");
      if(heroStart){
        heroStart.addEventListener("click", ()=>{
          try{
            if(typeof showCatsView === "function"){
              showCatsView();
            }
            const target = document.getElementById("catsView");
            if(target){
              target.scrollIntoView({ behavior:"smooth", block:"start" });
            }
          }catch(e){
            console.error(e);
          }
        });
      }
      const quickHelp = document.getElementById("quickHelp");
      if(quickHelp){
        quickHelp.addEventListener("click", ()=>{
          const base = `https://wa.me/${ASSETS.WHATSAPP_PHONE}`;
          const msg = encodeURIComponent("Ù…Ø´ ÙØ§Ø¶ÙŠØ© Ø£Ø¯ÙˆÙ‘Ø± ÙƒØªÙŠØ±ØŒ Ø³Ø§Ø¹Ø¯ÙˆÙ†ÙŠ Ø£Ø¸Ø¨Ø· Ø·Ù„Ø¨ Ù„Ø·Ø¨Ø®Ø© Ø£Ùˆ Ø¹Ø²ÙˆÙ…Ø© ğŸ™");
          window.open(`${base}?text=${msg}`,"_blank");
        });
      }
    }

    function setupRevealAnimations(){
      if(!("IntersectionObserver" in window)) return;
      const observer = new IntersectionObserver((entries)=>{
        entries.forEach(entry=>{
          if(entry.isIntersecting){
            entry.target.classList.add("reveal-show");
            observer.unobserve(entry.target);
          }
        });
      }, { threshold:0.12 });

      document.querySelectorAll("[data-reveal]").forEach(el=>{
        el.classList.add("reveal");
        observer.observe(el);
      });
    }

async function boot(){
      try{
        const csv=await fetchCSVText(CSV_URL);
        const items=csvToObjects(csv);
        window.__ALL__=items;

        ["q","cat","brand","min","max","offersOnly","onlyAvailable"].forEach(id=> el(id).addEventListener("input", ()=>applyFilters(window.__ALL__)));
        el("reload").addEventListener("click", ()=>applyFilters(window.__ALL__));

        // Ø£ÙˆÙ„ Ù…Ø§ Ø§Ù„ØµÙØ­Ø© ØªÙØªØ­ â†’ Ø£Ù‚Ø³Ø§Ù… Ø¨Ø³
        buildFilters(items);
        buildCats(items);
        showCatsView();

        setupHeroActions();
        setupRevealAnimations();

        // Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø£Ù‚Ø³Ø§Ù…
        el("backCats").addEventListener("click", ()=>{
          CURRENT_CATEGORY = "";
          el("cat").value = "";
          showCatsView();
        });

        // Ø²Ø± Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙÙ„Ø§ØªØ±
        const filtersPanel = el("filtersPanel");
        el("filtersBtn").addEventListener("click", ()=>{
          filtersPanel.classList.toggle("hidden");
        });
      }catch(e){ console.error(e); el("grid").innerHTML="<div class='empty'>Ø­ØµÙ„ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„</div>" }
    }
    document.documentElement.style.setProperty("--pattern-url", `url('${ASSETS.PATTERN_URL}')`);
    boot();
  </script>
</body>
</html>
